@page "/"

@using Microsoft.AspNetCore.Mvc
@using Microsoft.EntityFrameworkCore
@using SwiftMart.Data
@using SwiftMart.Models
@inject SWdbcontext dbContext
@inject NavigationManager Navigation

<PageTitle>Swift Mart</PageTitle>



@if (products != null && products.Any())
{
    <div class="grid grid-cols-3 gap-4">    

        @foreach (var product in products)
        {
        <div class="card card-compact w-96 bg-base-100 shadow-xl">
                <div    class="card border-light mb-3" style="cursor: pointer;" @onclick="() => NavigateToProductDetails(product.Id.ToString())">
                    @if (product.ImageData != null)
                    {
                        <div class="max-h-48 w-32">
                    <img class="transform motion-safe:hover:scale-110" src="@($"data:image/png;base64,{Convert.ToBase64String(product.ImageData)}")" alt="Product Image" />
                    </div>

                    }
                    <div class="card-body">
                        <h2 class="card-title">@product.Name</h2>
                        <div class="card-action justify-center-end">
                        <h3 class="price">$ @product.Price</h3>
                        </div>
                        </div>
                </div>
            </div>
        }

    </div>
}
else
{
    <p>No products found.</p>
}

@code {
    List<SwiftMart.Models.Product> products;

    protected override async Task OnInitializedAsync()
    {
        // Retrieve products from the database
        products = await dbContext.Products.ToListAsync();
    }

    private void NavigateToProductDetails(string productId)
    {
        Navigation.NavigateTo($"/products/{productId}");
    }
}



